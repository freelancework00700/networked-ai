<ion-header mode="md">
  <ion-toolbar mode="md">
    <div class="p-4 flex items-center justify-between">
      <i class="pi pi-arrow-left" (click)="close()"></i>
      <div class="heading-h3 neutral-01">Manage Roles</div>
      <i class="pi pi-times" (click)="close()"></i>
    </div>
  </ion-toolbar>
</ion-header>

<div class="inner-content px-4 pb-4">
  <form [formGroup]="form()">
    <div formArrayName="users" class="flex flex-col gap-2">
      @for (ctrl of usersFormArray.controls; track $index) {
        <div [formGroupName]="$index" class="flex items-center justify-between">
          <div class="flex items-center gap-2">
            <img [src]="ctrl.value.image || 'assets/images/profile.jpeg'" [alt]="ctrl.value.name" class="w-12 h-12 rounded-full object-cover" />
            <div>{{ ctrl.value.name }}</div>
          </div>

          <p-select
            class="h-11"
            optionLabel="name"
            [options]="roles()"
            optionValue="value"
            formControlName="role"
            placeholder="Select Role"
            (onChange)="changeRole($index, $event.value)"
          >
            <ng-template pTemplate="item" let-option>
              <div class="flex items-center gap-2">
                <div class="font-medium truncate">{{ option.name }}</div>
              </div>
            </ng-template>
          </p-select>
        </div>
      }
    </div>
  </form>
</div>
