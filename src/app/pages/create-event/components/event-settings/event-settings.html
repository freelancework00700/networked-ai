<div class="flex flex-col gap-6">
  <!-- Require RSVP Approval -->
  <toggle-input [formGroup]="eventForm()" controlName="show_time_picker" label="Show Time?" />
  <toggle-input [formGroup]="eventForm()" controlName="require_rsvp_approval" label="Require RSVP Approval?" />
  <!-- Repeating Event -->
  @if (!isModalMode()) {
    <div>
      <toggle-input [formGroup]="eventForm()" controlName="is_repeating" label="Repeating Event" />

      @if (getFieldValue('is_repeating')) {
        <div class="w-full mt-2">
          <div class="border-l-3 border-neutral-300 pl-3">
            <!-- Repeat Frequency -->
            <div class="flex gap-2 mb-4">
              @for (item of repeatOptions(); track item.value) {
                <chip
                  [type]="item.value"
                  [color]="getFieldValue('repeat_frequency') === item.value ? 'lgold' : ''"
                  (selectedType)="setRepeatFrequency(item.value)"
                  class="w-full"
                >
                  <span class="body-14R flex justify-center">
                    {{ item.label }}
                  </span>
                </chip>
              }
            </div>
            <!-- Repeat Count -->
            <label class="neutral-02 body-14M block mb-2"> How many times will the event occur in total? </label>

            <div class="flex gap-2">
              @for (item of repeatCountOptions(); track item.value) {
                @if (item.value !== 'custom') {
                  <chip
                    [type]="item.value.toString()"
                    [color]="getFieldValue('repeat_count') === item.value ? 'lgold' : ''"
                    (selectedType)="handleRepeatCountClick(item.value)"
                  >
                    <span class="body-14R">
                      {{ item.label }}
                    </span>
                  </chip>
                } @else {
                  <!-- Custom input button -->
                  <div>
                    <number-input
                      [formGroup]="eventForm()"
                      controlName="custom_repeat_count"
                      placeholder="Custom"
                      [min]="5"
                      [max]="50"
                      class="w-14"
                    ></number-input>
                  </div>
                }
              }
            </div>
          </div>

          <!-- Repeating Events List -->
          @if (repeatingEvents().length > 0) {
            <div class="mt-4">
              <div class="flex flex-col gap-2">
                @for (event of repeatingEvents(); track event['id']) {
                  <repeating-event-item
                    [event]="event"
                    [isMainEvent]="event['eventNumber'] === 1"
                    (edit)="editRepeatingEvent(event)"
                    (delete)="deleteRepeatingEvent(event['id'])"
                  />
                }
              </div>
            </div>
          }
        </div>
      }
    </div>
  }
  <!-- Co-Hosts -->
  <participant-input label="Co-Host(s)" type="co-host" [selectedUsers]="coHosts()" (usersChange)="onUsersChange($event, 'co_hosts')" />

  <!-- Sponsors -->
  <participant-input label="Sponsor(s)" type="sponsor" [selectedUsers]="sponsors()" (usersChange)="onUsersChange($event, 'sponsors')" />

  <!-- Speakers -->
  <participant-input label="Speaker(s)" type="speaker" [selectedUsers]="speakers()" (usersChange)="onUsersChange($event, 'speakers')" />

  <!-- Visibility -->
  <div class="flex items-center justify-between">
    <label class="neutral-02 body-14M">Visibility</label>
    <div class="flex gap-2">
      <chip [type]="visibility()" [color]="visibility() === 'public' ? 'lgold' : ''" (selectedType)="setVisibility('public')">
        <span class="body-14R">Public</span>
      </chip>
      <chip [type]="visibility()" [color]="visibility() === 'invite-only' ? 'lgold' : ''" (selectedType)="setVisibility('invite-only')">
        <span class="body-14R">Invite Only</span>
      </chip>
    </div>
  </div>

  <!-- Allow +1's -->
  <div>
    <toggle-input [formGroup]="eventForm()" controlName="allow_plus_ones" label="Allow +1's?" />

    @if (getFieldValue('allow_plus_ones')) {
      <div class="w-full border-l-3 border-neutral-300 pl-2 mt-2">
        <label class="neutral-02 body-14M block mb-2"> How many additional person per guest? </label>

        <div class="flex flex-wrap gap-3">
          @for (item of [1, 2, 3, 4, 5, 6, 7, 8, 9]; track item) {
            <chip [type]="item.toString()" [color]="getFieldValue('plus') === item ? 'lgold' : ''" (selectedType)="setPlusCount(item)">
              <span class="body-14R">+{{ item }}</span>
            </chip>
          }
        </div>
      </div>
    }
  </div>

  <!-- Questionnaire Section -->
  <div>
    <label class="neutral-02 body-14M block mb-4">Questionnaire</label>
    <div class="flex flex-col gap-4">
      @for (section of sections(); track section.type) {
        <div class="border border-neutral-300 rounded-lg p-4">
          <!-- Header Row: Label and Action Buttons -->
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-2">
              @if (hasQuestions(section.type)) {
                <img src="assets/svg/checkIcon.svg" alt="{{ section.label }}" class="w-5 h-5" />
              }
              <div class="font-medium text-surface-900">{{ section.label }}</div>
            </div>

            <div class="flex gap-4">
              @if (!hasQuestions(section.type)) {
                <button (click)="openQuestionnaireModal(section.type)">
                  <i class="pi pi-plus text-gray-700"></i>
                </button>
              } @else {
                <button (click)="openQuestionnaireModal(section.type)">
                  <img src="assets/svg/editIcon.svg" alt="Edit" />
                </button>

                <button (click)="deleteEventQuestionnaire(section.type)">
                  <img src="assets/svg/deleteIcon.svg" alt="Delete" />
                </button>
              }
            </div>
          </div>

          <!-- Content Row: List of questions or placeholder -->
          <div class="mt-2">
            @if (!hasQuestions(section.type)) {
              <div class="text-sm text-gray-500">{{ section.placeholder }}</div>
            } @else {
              <ul class="list-disc list-inside text-sm text-gray-500 space-y-1 pl-2">
                @for (question of getSectionQuestions(section.type); track question.id) {
                  <li>{{ question.question }}</li>
                }
              </ul>
            }
          </div>
        </div>
      }
    </div>
  </div>
</div>
