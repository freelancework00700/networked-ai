<ion-header [translucent]="true">
  <ion-toolbar>
    <div class="flex justify-between items-center px-4">
      <ion-icon src="/assets/svg/back-arrow.svg" class="h-[20px] w-[20px]" (click)="goBack()"></ion-icon>
      <div class="flex items-center gap-4">
        <ion-icon src="/assets/svg/share.svg" class="h-[20px] w-[20px]" (click)="shareEvent()"></ion-icon>
        <ion-icon src="/assets/svg/like.svg" class="h-[20px] w-[20px]" (click)="likeEvent()"></ion-icon>
        <ion-icon src="/assets/svg/dots-vertical.svg" class="h-[20px] w-[20px]" (click)="menu.toggle($event)"></ion-icon>
      </div>
    </div>
    <p-menu #menu [popup]="true" [model]="eventMenuItems" appendTo="body"> </p-menu>
  </ion-toolbar>
</ion-header>
<ion-content [fullscreen]="true" mode="md">
  <div class="w-full max-w-[672px] mx-auto bg-neutral-0">
    <div class="-mt-[44px]">
      <img
        src="https://images.unsplash.com/photo-1489515217757-5fd1be406fef?auto=format&fit=crop&w=800&q=80"
        alt="Event image 1"
        class="w-full h-[400px] object-cover"
      />
    </div>
    <div class="px-4 pt-2">
      <div
        class="flex items-center justify-between rounded-[12px] border border-[#DBDBDB] bg-gradient-to-r from-[#fff7ee] to-[#fefaf3] pl-1.5 pr-3 py-1.5 shadow-[2px_16px_19px_0_rgba(0,0,0,0.09)]"
      >
        <div class="flex items-center gap-1.5">
          <div class="w-10 h-10 flex items-center justify-center rounded-[8px] bg-brand-06 neutral-01 relative">
            <ion-icon src="../../../../assets/svg/ticket.svg" class="h-[20px] w-[20px]"></ion-icon>
            <ion-icon src="../../../../assets/svg/check-badge-green.svg" class="absolute bottom-0.5 right-0.5 h-[16px] w-[16px]"></ion-icon>
          </div>
          <div class="body-14R neutral-01">You've registered for this event</div>
        </div>
        <div class="flex items-center gap-1">
          <div class="body-14M brand-03">My Ticket</div>
          <div class="pi pi-arrow-right !text-[16px] brand-03"></div>
        </div>
      </div>
    </div>
    <div class="date-selector-container px-4 flex flex-col gap-0 pt-4">
      <segment-button [value]="selectedDate()" [items]="dateItems()" (valueChange)="onDateChange($event)" />
    </div>

    <div class="flex flex-col gap-8 pt-4 relative">
      <div class="flex flex-col gap-4 px-4">
        <div class="flex flex-col gap-1">
          <!-- top chips -->
          <div class="flex items-center gap-2">
            <div class="flex items-center gap-2">
              <span class="inline-flex items-center px-2.5 py-1 rounded-full bg-neutral-06 body-10 neutral-02 border border-[#E5E5E5]"
                >Public Event</span
              >
            </div>
            <div class="flex items-center gap-1.5 body-12 neutral-03">
              <span class="inline-flex items-center px-2 py-1 rounded-full bg-neutral-06 body-10 neutral-02 border border-[#E5E5E5]">14 Views</span>
            </div>
            <!-- <div class="flex items-center gap-1 border border-[#05512D] px-2 py-0.5 rounded-full bg-[#ECFEEE]">
              <ion-icon src="/assets/svg/heart-hand.svg" class="h-4 w-4 text-[#05512D]"></ion-icon>
              <span class="inline-flex items-center body-12 text-[#05512D]">Fundraiser</span>
            </div> -->
            @if (subscriptionPlanType() === 'event') {
              <div class="inline-flex items-center px-2 py-1 body-10 gap-1.5 text-white rounded-full bg-blue-600">
                <ion-icon src="/assets/svg/crown-white.svg" class="text-[12px]"></ion-icon>
                <span>Free for Subscribers</span>
              </div>
            }
            @if (subscriptionPlanType() === 'sponsor') {
              <div class="subscriber-chip inline-flex items-center px-2 py-1 gap-1.5 body-10 text-[#5c3c09f0]">
                <ion-icon src="/assets/svg/crown-sponsor.svg" class="text-[12px]"></ion-icon>
                <span>Subscribers Exclusive</span>
              </div>
            }
          </div>
          <!-- title & host -->
          <div class="body-16SB neutral-01">Atlanta Makes Me Laugh</div>
          <div class="flex items-center gap-1 body-12 neutral-03">
            <span>Hosted by</span>
            <button type="button" class="body-12SB brand-02 flex items-center gap-1">
              <span>Networked AI</span>
              <i class="pi pi-arrow-up-right !text-[12px]"></i>
            </button>
          </div>
        </div>
        <!-- details rows -->
        <div class="flex flex-col gap-3">
          <!-- date & time -->
          <div class="flex items-start gap-1.5">
            <div class="pi pi-calendar neutral-03 !text-[16px] mt-0.5"></div>
            <div class="flex items-center justify-between gap-1 w-full">
              <div class="body-14R neutral-03">Date &amp; Time</div>
              <div class="body-14R neutral-01">Fri 8/30, 07:00AM - 09:30AM</div>
            </div>
          </div>

          <!-- admission -->
          <div class="flex items-start gap-1.5">
            <div class="pi pi-ticket neutral-03 !text-[16px] mt-0.5"></div>
            <div class="flex items-center justify-between gap-1 w-full">
              <div class="body-14R neutral-03">Admission</div>
              <div class="body-14R neutral-01">from $10.00</div>
            </div>
          </div>

          <!-- location -->
          <div class="flex items-start gap-1.5">
            <div class="pi pi-map-marker neutral-03 !text-[16px] mt-0.5"></div>
            <div class="flex items-center justify-between gap-1 w-full">
              <div class="body-14R neutral-03">Location</div>
              <div class="body-14R neutral-01">Bar Diver Atlanta, GA 50412</div>
            </div>
          </div>
        </div>
      </div>
      <!-- Fundraising Card -->
      <!-- <div class="px-4">
        <div class="rounded-[16px] border border-[#DBDBDB] bg-white overflow-hidden p-2 flex flex-col gap-2">
          <div class="rounded-[8px] bg-[#ECFEEE] px-3 py-2 flex items-center justify-between">
            <div class="flex items-center gap-2">
              <ion-icon src="/assets/svg/heart-hand.svg" class="h-5 w-5 text-[#05512D]"></ion-icon>
              <span class="body-12 neutral-01">This event is raising funds for charity.</span>
            </div>
            <ion-icon src="/assets/svg/info-circle.svg" class="h-5 w-5 neutral-03"></ion-icon>
          </div>
          <div class="p-2 flex flex-col gap-4">
            <div class="flex flex-col gap-2">
              <div class="flex">
                <div class="inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-neutral-07 border border-[#E5E5E5]">
                  <span class="body-12 neutral-02">ðŸ“š Education </span>
                </div>
              </div>
              <div>
                <div class="pb-[6px]">
                  <div class="body-16SB neutral-01">Help The Comet's Get The Gear They Need</div>
                </div>
                <div class="w-full h-2.5 rounded-full bg-neutral-06 overflow-hidden">
                  <div class="h-full rounded-full bg-gradient-to-r from-[#FF9800] to-[#FFB74D]" style="width: 39.2%"></div>
                </div>
                <div class="flex items-center justify-between pt-1">
                  <div class="body-14SB neutral-01">$1,568</div>
                  <div class="body-12 neutral-01">$4,000 Goal</div>
                </div>
              </div>
            </div>
            <div class="flex gap-2">
              <app-button label="Read the Story" color="secondary" class="h-[40px] w-full" />
              <app-button label="Donate Now" class="h-[40px] w-full" />
            </div>
          </div>
        </div>
      </div> -->
      @for (section of userSections(); track section.title) {
        <div class="flex flex-col gap-3 px-4">
          <div class="flex items-center justify-between">
            <div class="body-14SB neutral-01">{{ section.title }}</div>
            <i class="pi pi-arrow-right neutral-02 !text-[16px] cursor-pointer" (click)="openUserList(section.title, section.users)"></i>
          </div>
          <avatar-group [users]="section.users" />
        </div>
      }
      <div class="flex flex-col gap-3 px-4">
        <!-- image slider -->
        <div class="relative rounded-[16px] overflow-hidden">
          <div class="swiper swiper-event-detail">
            <div class="swiper-wrapper">
              <div class="swiper-slide">
                <img
                  src="https://images.unsplash.com/photo-1489515217757-5fd1be406fef?auto=format&fit=crop&w=800&q=80"
                  alt="Event image 1"
                  class="w-full h-[361px] object-cover"
                />
              </div>
              <div class="swiper-slide">
                <img
                  src="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=800&q=80"
                  alt="Event image 2"
                  class="w-full h-[361px] object-cover"
                />
              </div>
              <div class="swiper-slide">
                <img
                  src="https://images.unsplash.com/photo-1444840535719-195841cb6e2b?auto=format&fit=crop&w=800&q=80"
                  alt="Event image 3"
                  class="w-full h-[361px] object-cover"
                />
              </div>
            </div>
            <!-- default swiper pagination bullets -->
            <div class="swiper-pagination"></div>
          </div>
        </div>

        <!-- description text -->
        <p class="body-14M neutral-02">
          Secondhand item, 16-50mm interchangeable lenses. Iâ€™ll give you a free 16GB SD Card. Used for 6 months before I decide to buy another camera
          for my streams. Open for negotiation.
        </p>
      </div>
      <div class="px-4">
        <div class="w-full rounded-[16px] overflow-hidden" style="height: 300px; position: relative">
          <div #mapContainer class="event-map"></div>
        </div>
      </div>
      <host-event-promo-card />
    </div>
  </div>
</ion-content>
<ion-footer class="ion-padding-horizontal" mode="md">
  <ion-toolbar class="ion-no-padding" style="--background: transparent" mode="md">
    <div class="pb-4 max-w-[672px] mx-auto">
      <app-button label="RSVP Now from $10.00" height="40px" (click)="openRsvpModal()" />
      <app-button label="Manage Event" height="40px" (click)="openMenu()" />
    </div>
  </ion-toolbar>
</ion-footer>
