<ion-header mode="md">
  <ion-toolbar>
    <div class="flex items-center gap-2 px-4 pt-2.5 cursor-pointer max-w-[672px] mx-auto">
      <i class="pi pi-arrow-left" (click)="back()"></i>
      <div class="body-14M text-center w-full">Event QR</div>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content fullscreen mode="md">
  @if (event) {
    <div class="flex justify-center overflow-y-auto">
      <div class="w-full max-w-[672px] p-6 flex flex-col">
        <div class="relative rounded-[30px] p-1 border-3" #downloadableSection [ngClass]="progressBarColor()">
          <div class="relative rounded-[28px] overflow-hidden text-white">
            <div class="absolute inset-0 bg-cover bg-center" [style.backgroundImage]="'url(' + getImageUrl(event.thumbnail_url) + ')'"></div>
            <div class="absolute inset-0 bg-black/30"></div>

            <div class="relative flex flex-col justify-end min-h-[520px] p-4">
              <div class="detail-card border-3" [ngClass]="progressBarColor()">
                <div class="heading-h2">{{ event.title }}</div>
                <div class="text-white mb-4">{{ host()?.name }}</div>

                <div class="flex justify-center mb-4">
                  <div class="bg-white rounded-2xl p-2 border gradient-border">
                    <qr-code [value]="eventLink()" [size]="128" errorCorrectionLevel="M"></qr-code>
                  </div>
                </div>

                <div class="flex items-center gap-4 mb-4">
                  <div class="border border-surface-400 rounded-full p-3">
                    <i class="pi pi-calendar"></i>
                  </div>
                  <div>
                    <div class="body-14M">{{ formattedEventDate() }}</div>
                    <div class="text-surface-400">{{ formattedEventTime() }}</div>
                  </div>
                </div>

                <div class="flex items-center gap-4">
                  <div class="border border-surface-400 rounded-full p-3">
                    <i class="pi pi-map-marker"></i>
                  </div>
                  <div>
                    <div class="body-14M">{{ event.address }}</div>
                    <div class="text-surface-400">{{ event.state }}, {{ event.country }}</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="mt-5 flex flex-col gap-3">
          <app-button label="Share" iconName="pi pi-upload" iconPos="right" color="secondary" (click)="shareQR()" />
          <app-button
            label="Download"
            iconName="pi pi-download"
            iconPos="right"
            color="secondary"
            (click)="downloadQR()"
            [isLoading]="isDownloading()"
            [disabled]="isDownloading()"
          />
        </div>
      </div>
    </div>
  } @else {
    <div class="h-full flex justify-center">
      <div class="w-full max-w-[672px] p-6 flex flex-col animate-pulse">
        <!-- Card Skeleton -->
        <div class="relative rounded-[28px] p-1 border-3 border-surface-400 flex-1">
          <div class="relative h-full rounded-[28px] overflow-hidden bg-neutral-06">
            <!-- Background -->
            <ion-skeleton-text animated class="absolute inset-0 w-full h-full"></ion-skeleton-text>

            <!-- Bottom Content -->
            <div class="absolute bottom-0 left-0 right-0 p-4">
              <div class="detail-card">
                <!-- Title -->
                <ion-skeleton-text animated class="w-3/4 h-6 rounded mb-2"></ion-skeleton-text>

                <!-- Subtitle -->
                <ion-skeleton-text animated class="w-1/2 h-4 rounded mb-4"></ion-skeleton-text>

                <!-- QR Skeleton -->
                <div class="flex justify-center mb-6">
                  <ion-skeleton-text animated class="w-40 h-40 rounded-lg"></ion-skeleton-text>
                </div>

                <!-- Date -->
                <div class="flex items-center gap-4 mb-4">
                  <ion-skeleton-text animated class="w-10 h-10 rounded-full"></ion-skeleton-text>
                  <div class="flex flex-col gap-2 flex-1">
                    <ion-skeleton-text animated class="w-2/3 h-4 rounded"></ion-skeleton-text>
                    <ion-skeleton-text animated class="w-1/2 h-3 rounded"></ion-skeleton-text>
                  </div>
                </div>

                <!-- Location -->
                <div class="flex items-center gap-4">
                  <ion-skeleton-text animated class="w-10 h-10 rounded-full"></ion-skeleton-text>
                  <div class="flex flex-col gap-2 flex-1">
                    <ion-skeleton-text animated class="w-2/3 h-4 rounded"></ion-skeleton-text>
                    <ion-skeleton-text animated class="w-1/2 h-3 rounded"></ion-skeleton-text>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Buttons Skeleton -->
        <div class="mt-5 flex flex-col gap-3">
          <ion-skeleton-text animated class="w-full h-12 rounded-lg"></ion-skeleton-text>
          <ion-skeleton-text animated class="w-full h-12 rounded-lg"></ion-skeleton-text>
        </div>
      </div>
    </div>
  }
</ion-content>
