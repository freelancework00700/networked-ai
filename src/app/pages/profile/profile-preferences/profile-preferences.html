<ion-header>
  <ion-toolbar>
    <div class="p-6 max-w-[672px] mx-auto">
      <div class="flex items-center justify-between">
        <div class="pi pi-arrow-left cursor-pointer" (click)="goBack()"></div>
        @if (isMultiStep()) {
          <button type="button" class="body-14M neutral-03 cursor-pointer" (click)="skip()">Skip</button>
        }
      </div>

      <div class="heading-h2 mt-6">{{ currentStepData().title }}</div>
      <div class="body-14R">
        {{ currentStepData().description }}
      </div>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="w-full px-6 max-w-[672px] mx-auto">
    @if (isLoading()) {
      <!-- loading State -->
      <div class="flex flex-col items-center justify-center min-h-[400px]">
        <ion-spinner name="crescent" />
        <p class="body-14R neutral-03 mt-4">Loading...</p>
      </div>
    } @else if (hasNoData()) {
      <!-- no data state -->
      <div class="flex flex-col items-center justify-center min-h-[400px]">
        <h3 class="body-16SB neutral-01 mb-2">No Data Found</h3>
      </div>
    } @else {
      <!-- items list -->
      <div class="grid grid-cols-2 gap-4">
        @for (item of currentItems(); track item.id) {
          <div
            class="vibe-card"
            (click)="toggleItem(item.id)"
            [class.selected]="isSelected(item.id)"
            [class.disabled]="!isSelected(item.id) && !canSelectMore()"
          >
            <!-- icon -->
            <div class="text-2xl">{{ item.icon }}</div>

            <!-- name -->
            <div class="body-14M mt-2">{{ item.name }}</div>

            <!-- description -->
            @if (item.description) {
              <div class="body-12 neutral-03">{{ item.description }}</div>
            }
          </div>
        }
      </div>
    }
  </div>
</ion-content>

<ion-footer>
  <ion-toolbar>
    <div class="flex items-center justify-between p-6 max-w-[672px] mx-auto">
      @if (isMultiStep()) {
        <!-- steps -->
        <div class="flex items-center gap-1">
          @for (step of [1, 2, 3]; track step) {
            <div
              class="rounded-full transition-all duration-200"
              [class]="step === currentStep() ? 'w-8 h-2 bg-black' : step < currentStep() ? 'w-2 h-2 bg-black' : 'w-2 h-2 bg-gray-300'"
            ></div>
          }
        </div>

        <!-- navigation buttons -->
        <app-button
          width="96px"
          height="48px"
          (click)="next()"
          [isLoading]="isLoading()"
          [label]="isMultiStep() && currentStep() === totalSteps() ? 'Finish' : 'Next'"
        />
      } @else {
        <app-button class="w-full" (click)="next()" label="Save Changes" [isLoading]="isLoading()" />
      }
    </div>
  </ion-toolbar>
</ion-footer>
