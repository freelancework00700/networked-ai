<ion-header>
  <ion-toolbar>
    <div class="flex items-center gap-2 max-sm:px-4 pt-2.5 cursor-pointer max-w-[672px] mx-auto" (click)="previousStep()">
      <div class="pi pi-arrow-left"></div>
      <div class="body-14M neutral-02 text-center w-full">Setup Your Profile</div>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="min-h-full">
    <div class="w-full p-6 max-w-[672px] mx-auto">
      <form [formGroup]="profileForm()" (ngSubmit)="update()" class="h-full">
        <!-- Step 1: Personal Information -->
        @if (currentStep() === 1) {
          <div class="flex flex-col gap-6">
            <div class="heading-h2 neutral-01">Personal Details</div>
            <div class="flex flex-col gap-4">
              <!-- title input -->
              <modal-input controlName="title" label="Title" placeholder="Select title" type="select" [options]="titleOptions" />

              <!-- name input -->
              <div class="flex items-center gap-2 w-full">
                <text-input controlName="first_name" label="First Name" class="w-full" />
                <text-input controlName="last_name" label="Last Name" class="w-full" />
              </div>

              <!-- email input -->
              <email-input />

              <!-- phone input -->
              <mobile-input />

              <!-- username input -->
              <username-input (verificationStateChange)="usernameVerified.set($event)" />

              <!-- birthdate input -->
              <modal-input controlName="birthdate" label="Birthdate" placeholder="Select birthdate" type="date" iconName="pi pi-calendar" />

              <!-- account type input -->
              <modal-input
                type="select"
                label="Account Type"
                controlName="account_type"
                placeholder="Select account type"
                [options]="accountTypeOptions"
              />

              <!-- Location & Location Settings -->
              <div class="flex flex-col gap-4">
                <h5 class="text-lg font-semibold">Location & Location Settings</h5>

                <!-- City/Location input -->
                <modal-input controlName="location" label="City/Location" placeholder="Select location" type="location" iconName="pi pi-map-marker" />

                <!-- Incognito Mode Toggle -->
                <incognito-mode-input />
              </div>
            </div>
          </div>
        }

        <!-- Step 2: Additional Information -->
        @if (currentStep() === 2) {
          <div class="space-y-4 flex flex-col gap-4">
            <div class="heading-h2 neutral-01">More About You</div>
            <!-- college/university input -->
            <text-input controlName="college_university" label="College/University" [required]="false" />

            <!-- company input -->
            <text-input controlName="company" label="Company" [required]="false" />

            <!-- about input -->
            <text-area-input label="About Me" controlName="aboutMe" [required]="false" placeholder="Write description here" />

            <!-- sites & socials -->
            <social-input />
          </div>
        }

        <!-- Step 3: Profile Image -->
        @if (currentStep() === 3) {
          <div class="h-full flex items-center justify-center">
            <div class="flex flex-col items-center justify-center">
              <div class="heading-h2 neutral-01 mb-8">Upload Photo</div>
              <image-input controlName="profile_image" label="Profile Picture" [required]="false" (skipped)="nextStep()" />
              <button type="button" (click)="nextStep()" class="body-14M neutral-03 mt-6">Skip Now</button>
            </div>
          </div>
        }

        <!-- Step 4: Network Suggestions -->
        @if (currentStep() === 4) {
          <div class="flex flex-col gap-4">
            <div class="heading-h2 neutral-01">Network Suggestion</div>

            <!-- Network Suggestions List -->
            <div class="mb-4">
              @for (suggestion of networkSuggestions; track suggestion.id) {
                <div class="flex items-center gap-3 bg-surface-0 py-4">
                  <!-- Profile Picture -->
                  <div class="w-12 h-12 rounded-full bg-surface-100 border-2 border-surface-200 flex items-center justify-center flex-shrink-0">
                    <i class="pi pi-user text-surface-400 text-xl"></i>
                  </div>

                  <!-- Name and Details -->
                  <div class="flex-1 flex flex-col gap-1">
                    <div class="flex items-center gap-2">
                      <div class="body-14SB neutral-01 truncate">{{ suggestion.name }}</div>
                      <div class="flex items-center gap-1 border border-[#dbdbdb] rounded-full py-0 h-[20px]">
                        <img src="assets/svg/diamondYellow.svg" alt="diamond" class="h-4 w-auto ml-1.5" />
                        <span class="text-sm font-medium pr-2">{{ suggestion.value }}</span>
                      </div>
                    </div>
                    <p class="body-12 neutral-03">{{ suggestion.jobTitle }}, {{ suggestion.company }}</p>
                  </div>

                  <!-- Add Button -->
                  <app-button
                    [label]="isSelected(suggestion.id) ? 'Added' : 'Add'"
                    (click)="addSuggestion(suggestion.id)"
                    color="secondary"
                    width="60px"
                    height="32px"
                  >
                  </app-button>
                </div>
              }
            </div>
          </div>
        }
      </form>
    </div>
  </div>
</ion-content>

<ion-footer>
  <ion-toolbar>
    <div class="flex items-center justify-between w-full max-sm:px-4 max-sm:pb-8 pb-4 pt-2 max-w-[672px] mx-auto">
      <!-- Steps -->
      <div class="flex items-center gap-1">
        @for (step of steps(); track step) {
          <div
            class="rounded-full transition-all duration-200"
            [ngClass]="step === currentStep() ? 'w-8 h-2 bg-black' : step < currentStep() ? 'w-2 h-2 bg-black' : 'w-2 h-2 bg-gray-300'"
          ></div>
        }
      </div>
      <!-- Navigation Buttons -->
      <div class="flex items-center gap-2">
        @if (currentStep() === 4) {
          <app-button label="Finish" width="96px" height="48px" (click)="update()" />
        } @else if (currentStep() < steps().length) {
          <app-button label="Next" width="96px" height="48px" (click)="nextStep()" />
        } @else {
          <app-button label="Submit" width="96px" height="48px" (click)="update()" />
        }
      </div>
    </div>
  </ion-toolbar>
</ion-footer>
