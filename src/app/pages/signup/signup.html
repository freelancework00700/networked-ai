<ion-header>
  <ion-toolbar>
    <div class="flex items-center p-6 max-w-[672px] mx-auto">
      <div class="pi pi-arrow-left cursor-pointer" (click)="goBack()"></div>
      <div class="body-14M neutral-02 text-center w-full">Setup Your Profile</div>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="w-full p-6 max-w-[672px] mx-auto">
    <form [formGroup]="profileForm()" class="h-full">
      <!-- step 1: personal information -->
      <div [hidden]="currentStep() !== 1" class="flex flex-col gap-6">
        <div class="heading-h2 neutral-01">Personal Details</div>
        <user-personal-info
          [formGroup]="profileForm()"
          [isSubmitted]="isSubmitted()"
          (openDateModal)="openDateModal()"
          (openTitleModal)="openTitleModal()"
          (openLocationModal)="openLocationModal()"
          [showPasswordInput]="showPasswordInput()"
          (openAccountTypeModal)="openAccountTypeModal()"
        />
      </div>

      <!-- step 2: additional information -->
      <div [hidden]="currentStep() !== 2" class="space-y-4 flex flex-col gap-4">
        <div class="heading-h2 neutral-01">More About You</div>
        <user-additional-info [formGroup]="profileForm()" />
      </div>

      <!-- step 3: profile image -->
      <div [hidden]="currentStep() !== 3" class="absolute inset-0 flex items-center justify-center min-h-screen">
        <div class="flex flex-col items-center justify-center">
          <div class="heading-h2 neutral-01 mb-8">Upload Photo</div>
          <profile-image-input controlName="image_url" label="Profile Picture" [required]="false" (skipped)="save()" />
          <button type="button" (click)="save()" class="body-14M neutral-03 mt-6">Skip Now</button>
        </div>
      </div>

      <!-- step 4: network suggestions -->
      <div [hidden]="currentStep() !== 4" class="flex flex-col gap-4">
        <div class="heading-h2 neutral-01">Network Suggestion</div>

        <!-- network suggestions list -->
        <div class="mb-4">
          @for (suggestion of networkSuggestions; track suggestion.id) {
            <div class="flex items-center gap-3 bg-surface-0 py-4">
              <!-- profile picture -->
              <div class="w-12 h-12 rounded-full bg-surface-100 border-2 border-surface-200 flex items-center justify-center flex-shrink-0">
                <i class="pi pi-user text-surface-400 text-xl"></i>
              </div>

              <!-- name and details -->
              <div class="flex-1 flex flex-col gap-1">
                <div class="flex items-center gap-2">
                  <div class="body-14SB neutral-01 truncate">{{ suggestion.name }}</div>
                  <div class="flex items-center gap-1 border border-[#dbdbdb] rounded-full py-0 h-[20px]">
                    <img src="assets/svg/diamondYellow.svg" alt="diamond" class="h-4 w-auto ml-1.5" />
                    <span class="text-sm font-medium pr-2">{{ suggestion.value }}</span>
                  </div>
                </div>
                <p class="body-12 neutral-03">{{ suggestion.jobTitle }}, {{ suggestion.company }}</p>
              </div>

              <!-- add button -->
              <app-button
                width="60px"
                height="32px"
                color="secondary"
                (click)="addSuggestion(suggestion.id)"
                [label]="isSelected(suggestion.id) ? 'Added' : 'Add'"
              />
            </div>
          }
        </div>
      </div>
    </form>
  </div>

  <!-- recaptcha container for phone authentication -->
  <div id="recaptcha-container"></div>
</ion-content>

<ion-footer>
  <ion-toolbar>
    <div class="flex items-center justify-between p-6 max-w-[672px] mx-auto">
      <!-- steps -->
      <div class="flex items-center gap-1">
        @for (step of steps(); track step) {
          <div
            class="rounded-full transition-all duration-200"
            [ngClass]="step === currentStep() ? 'w-8 h-2 bg-black' : step < currentStep() ? 'w-2 h-2 bg-black' : 'w-2 h-2 bg-gray-300'"
          ></div>
        }
      </div>
      <!-- navigation buttons -->
      <div class="flex items-center gap-2">
        <app-button width="96px" height="48px" label="Next" (click)="save()" [isLoading]="isLoading()" />
      </div>
    </div>
  </ion-toolbar>
</ion-footer>
